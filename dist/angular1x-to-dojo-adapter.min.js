define(["dojo/_base/declare","dijit/_WidgetBase"],function(e,t){return e([t],{$modules:null,$domNodeObserver:null,scope:null,constructor:function(e,t){var o,s,i,n,a=/^on(?=.+?)/;for(o=0;o<t.attributes.length;o++)s=t.attributes[o],i=s.value.toString(),a.test(s.name)&&(n=s.name.replace(a,"ng-"),e[n]=s.value,t.setAttribute(n,s.value),delete e[s.name],t.removeAttribute(s.name))},postCreate:function(){this.inherited(arguments);var e=angular.injector(["ng"].concat(this.$modules));e.invoke(["$compile","$rootScope",function(e,t){var o,s;delete this.params.$modules,delete this.params.template,this.scope=t.$new(),angular.extend(this.scope,this.params);for(o in this.scope)if("data-dojo-props"!==o&&this.domNode.attributes[o])delete this.scope[o];else if(this.scope.hasOwnProperty(o)&&/^[a-z]/i.test(o)){this.domNode.setAttribute(o.split(/(?=[A-Z])/).join("-").toLowerCase(),o);for(s in this.params)this.watch(s,this._onParamsChange);this.scope.$watch(o,this._onScopeChange.bind(this,o))}e(this.domNode)(this.scope,function(e,t){this.domNode.parentNode.replaceChild(e[0],this.domNode),this.domNode=e[0]}.bind(this))}.bind(this)])},destroy:function(){this.inherited(arguments),this.domNodeObserver.disconnect()},_onScopeChange:function(e,t,o){t!==o&&this.set(e,t)},_onParamsChange:function(e,t,o){if(o!==t){this.scope[e]=o;try{this.scope.$digest()}catch(s){console.info(s)}}}})});